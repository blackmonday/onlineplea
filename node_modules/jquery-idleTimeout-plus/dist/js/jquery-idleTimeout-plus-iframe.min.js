!function(t,o){"function"==typeof define&&define.amd?define(["jquery"],o):"object"==typeof exports?module.exports=o(require("jquery")):t.IdleTimeoutPlus=o(t.jQuery)}(this,function(t){function o(){null==ot&&(ot=$.localStorage?$.initNamespaceStorage("jqueryIdleTimeoutPlus").localStorage:{})}function n(t,o){_.multiWindowSupport?ot.set(t,o):ot[t]=o}function e(t,o){if(o="undefined"!=typeof o?o:null,_.multiWindowSupport){if(ot.isSet(t))return ot.get(t)}else if(t in ot)return ot[t];return o}function l(){n("warningStartTime",-1),n("lockStartTime",-1),i(),_.idleCallback!==!1&&_.idleCallback(_)}function i(){a(),n("lastActivity",$.now()),et=setInterval(r,_.idleCheckHeartbeat)}function a(){clearInterval(et)}function r(){var t=e("lastActivity",$.now())+_.idleTimeLimit;return e("logoutTriggered")===!0?N():-1!=e("lockStartTime",-1)?(a(),U()):$.now()>=t?(a(),_.warnEnabled?d():_.lockEnabled?A():O()):void 0}function c(){$(document).on(_.activityEvents,function(t){if("mousemove"===t.type){if(t.clientX===rt[0]&&t.clientY===rt[1])return;rt[0]=t.clientX,rt[1]=t.clientY}-1==e("warningStartTime",-1)&&-1==e("lockStartTime",-1)&&i()})}function u(){s(),lt=setInterval(function(){$.ajax({type:_.keepAliveAjaxType,url:_.keepAliveUrl,data:_.keepAliveAjaxData})},_.keepAliveInterval)}function s(){clearInterval(lt)}function d(){k(),_.warnCallback!==!1&&(ct=_.warnCallback(_)),w()}function p(){f(),m(),n("warningStartTime",-1),l()}function k(){n("warningStartTime",$.now()),it=setInterval(v,500)}function f(){clearInterval(it)}function v(){if(e("logoutTriggered")===!0)return f(),N();if(-1==e("warningStartTime",-1))return p();var t=e("warningStartTime")+_.warnTimeLimit-1;return $.now()>=t?(f(),_.lockEnabled?(m(),A()):O()):void b()}function w(){ct&&(g(),b(),_.bootstrap?st.modal("show"):st.dialog("open"),ut=!0)}function m(){ut=!1,null!==st&&(_.bootstrap?(st.modal("hide"),tt.removeClass("modal-open"),$("div.modal-backdrop").remove()):st.dialog("close"))}function b(){if(null!==st&&(null!==dt||null!==pt)){var t=$.now(),o=Math.floor((e("warningStartTime",t)+_.warnTimeLimit-t)/1e3);if(null!==dt&&dt.html(V(o)),null!=pt){var n=Math.floor(o/(_.warnTimeLimit/1e3)*100);_.bootstrap?pt.css("width",n+"%"):pt.progressbar("value",n)}}}function g(){if(null===st){var t="";t=_.warnContentCallback!==!1?_.warnContentCallback(_):_.bootstrap?j():C(),_.bootstrap?h(t):y(t)}}function h(t){tt.append(t),$("#jitp-warn-logout").on("click",function(){T()}),$("#jitp-warn-alive").on("click",function(){S()}),st=$("#jitp-warn-display"),(null!=_.warnCountdownMessage||_.warnCountdownBar)&&(dt=st.find(".jitp-countdown-holder")),_.warnCountdownBar&&(pt=$("#jitp-warn-bar"))}function y(t){$(t).dialog({buttons:[{text:_.warnLogoutButton,click:function(){T()}},{text:_.warnStayAliveButton,click:function(){S()}}],closeOnEscape:!1,modal:!0,title:_.warnTitle,minWidth:320,autoOpen:!1,open:function(){null==_.warnTitle?$(this).closest(".ui-dialog").find(".ui-dialog-titlebar").hide():$(this).closest(".ui-dialog").find(".ui-dialog-titlebar-close").hide(),$(this).parent().find("button:nth-child(2)").focus()}}),st=$("#jitp-warn-display"),null!=_.warnCountdownMessage&&(dt=st.find(".jitp-countdown-holder")),_.warnCountdownBar&&(pt=$("#jitp-warn-bar"),pt.progressbar({value:0,max:100}))}function j(){var t=_.warnTitle?'<div class="modal-header"><h4 class="modal-title">'+_.warnTitle+"</h4></div>":"",o=null!=_.warnCountdownMessage?"<p>"+_.warnCountdownMessage.replace(/{timer}/g,'<span class="jitp-countdown-holder"></span>')+"</p>":"",n=_.warnCountdownBar?'<div class="progress">               <div id="jitp-warn-bar" class="progress-bar progress-bar-striped active" role="progressbar" style="min-width: 15px; width: 100%;">                 <span class="jitp-countdown-holder"></span>               </div>             </div>':"";return'<div class="modal fade" id="jitp-warn-display" data-backdrop="static" data-keyboard="false">                 <div class="modal-dialog">                     <div class="modal-content">                          '+t+'                         <div class="modal-body">                             <p>'+_.warnMessage+"</p>                             "+o+"                             "+n+'                         </div>                         <div class="modal-footer">                             <button id="jitp-warn-logout" type="button" class="btn btn-default">'+_.warnLogoutButton+'</button>                             <button id="jitp-warn-alive" type="button" class="btn btn-primary">'+_.warnStayAliveButton+"</button>                         </div>                     </div>                 </div>             </div>"}function C(){var t=null!=_.warnCountdownMessage?"<p>"+_.warnCountdownMessage.replace(/{timer}/g,'<span class="jitp-countdown-holder"></span>')+"</p>":"",o=_.warnCountdownBar?'<div id="jitp-warn-bar"></div>':"";return'<div id="jitp-warn-display"><p>'+_.warnMessage+"</p>"+t+o+"</div>"}function T(){f(),D()}function S(){p()}function A(){_.lockHaltKeepAlive&&s(),M(),_.lockCallback!==!1&&(kt=_.lockCallback(_)),E()}function U(){_.lockHaltKeepAlive?s():_.keepAliveInterval&&u(),-1==e("lockStartTime",-1)?M():at=setInterval(B,500),E()}function L(){I(),x(),$("#jitp-lock-pass").val(""),_.keepAliveInterval&&u(),n("lockStartTime",-1),l()}function M(){n("lockStartTime",$.now()),at=setInterval(B,500)}function I(){clearInterval(at)}function B(){if(1==e("logoutTriggered"))return I(),N();if(-1==e("lockStartTime",-1))return L();var t=e("lockStartTime")+_.lockTimeLimit-1;return $.now()>=t?(I(),1==e("logoutTriggered")?N():O()):void q()}function E(){if(kt){W(),q();var t={message:$("#jitp-lock-display")};t=$.extend(t,_.lockBlockUiConfig),$.blockUI(t),ft=!0}}function x(){$.unblockUI(),ft=!1}function q(){if(null!==wt){var t=$.now(),o=Math.floor((e("lockStartTime",t)+_.lockTimeLimit-t)/1e3);wt.html(V(o))}}function W(){if(null===vt){var t="";t=_.lockContentCallback!==!1?_.lockContentCallback(_):_.bootstrap?P():H(),tt.append(t),vt=$("#jitp-lock-display"),0!=_.lockCountdownMessage&&(wt=vt.find(".jitp-countdown-holder")),$("#jitp-lock-logout").on("click",function(){Q()}),$("#jitp-lock-unlock").on("click",function(){K()}),$("#jitp-lock-form").length&&$("#jitp-lock-form").submit(function(){return K(),!1}),q()}}function P(){var t=null!==_.lockTitle?'<div class="panel-heading"><h2 class="panel-title">'+_.lockTitle+"</h2></div>":"",o=_.lockLogoutButton.replace(/{username}/g,_.lockUsername),n=_.lockCountdownMessage?'<div class="panel-footer">'+_.lockCountdownMessage.replace(/{timer}/g,'<span class="jitp-countdown-holder"></span>')+"</div>":"";return'<div id="jitp-lock-display" class="jitp-lock-back" style="display: none;">             <div class="panel panel-default jitp-lock-panel">                 '+t+'                 <div class="panel-body">                     <h4>'+_.lockUsername+"</h4>                     <p>"+_.lockMessage+'</p>                     <div class="input-group">                         <input id="jitp-lock-pass" type="password" class="form-control" placeholder="Password..."/>                         <span class="input-group-btn">                             <button id="jitp-lock-unlock" class="btn btn-primary" type="button">'+_.lockUnlockButton+'</button>                         </span>                     </div>                     <a id="jitp-lock-logout" href="javascript:;">'+o+"</a>                 </div>                 "+n+"            </div>            </div>"}function H(){var t=null!==_.lockTitle?"<header>"+_.lockTitle+"</header>":"",o=_.lockLogoutButton.replace(/{username}/g,_.lockUsername),n=_.lockCountdownMessage?"<footer>"+_.lockCountdownMessage.replace(/{timer}/g,'<span class="jitp-countdown-holder"></span>')+"</footer>":"";return'<div id="jitp-lock-display" class="jitp-lock-back" style="display: none;">             <div class="jitp-lock-panel jitp-lock-jqpanel">                 '+t+'                 <div class="jitp-lock-jqpanel-body">                     <h2>'+_.lockUsername+"</h2>                     <p>"+_.lockMessage+'</p>                     <div>                         <input id="jitp-lock-pass" type="text" class="form-control" placeholder="Password..."/>                     </div>                     <button id="jitp-lock-unlock" type="button">'+_.lockUnlockButton+'</button>                     <a id="jitp-lock-logout" href="javascript:;">'+o+"</a>                 </div>                 "+n+"            </div>            </div>"}function Q(){I(),D()}function K(){_.lockPassCallback($("#jitp-lock-pass").val())}function Y(){s(),a(),f(),I()}function D(){Y(),n("logoutTriggered",!0),("function"!=typeof _.logoutCallback||_.logoutCallback(_))&&window.location.replace(_.logoutUrl)}function N(){Y(),("function"!=typeof _.logoutAutoCallback||_.logoutAutoCallback(_))&&window.location.replace(_.logoutAutoUrl)}function O(){return Y(),_.multiWindowSupport?void setTimeout(X,Z(100,500)):X()}function X(){return e("logoutTriggered",!1)?N():(n("logoutTriggered",!0),void(("function"!=typeof _.redirectCallback||_.redirectCallback(_))&&window.location.replace(_.redirectUrl)))}function F(){n("activityEvents",_.activityEvents)}function G(){$(document).on("dialogopen shown.bs.modal",function(){ut||ft||J()})}function J(){var t,o=function(){"complete"===document.readyState&&(clearInterval(t),R())};t=setInterval(o,1e3)}function R(t){t||(t=$(document));var o=0;t.find("iframe,frame").each(function(){if($(this).hasClass("jitp-inspected")===!1)try{R($(this).contents()),$(this).on("load",z($(this)));var t=$(this)[o];t.attachEvent&&t.attachEvent("onload",z($(this))),o++}catch(n){$(this).addClass("jitp-inspected cross-site")}})}function z(t){var o=t.contents(),n=e("activityEvents","");try{o.on(n,function(t){$("body").trigger(t)}),t.addClass("jitp-inspected")}catch(l){}}function V(t){var o=Math.floor(t/60);if(15>=o){var n=t%60,e=o>0?o+"m ":"";return e+=n+"s"}if(75>=o)return 22>=o?"about 15 mins":37>=o?"about 30 mins":52>=o?"about 25 mins":"about 1 hour";var l=Math.floor(o/60);return o%=60,15>=o?"about "+l+" hours":o>52?"about "+(l+1)+" hours":"about "+l+"&frac12; hours"}function Z(t,o){return Math.floor(Math.random()*(o-t))+t}var _={idleTimeLimit:1200,idleCallback:!1,idleCheckHeartbeat:2,activityEvents:"click keypress scroll wheel mousewheel mousemove touchmove",bootstrap:!1,warnEnabled:!0,warnTimeLimit:180,warnCallback:!1,warnContentCallback:!1,warnTitle:"Session Timeout",warnMessage:"Your session is about to expire!",warnStayAliveButton:"Stay Connected",warnLogoutButton:"Logout",warnCountdownMessage:"Time remaining: {timer}",warnCountdownBar:!1,redirectUrl:"/timed-out",logoutUrl:"/logout",logoutAutoUrl:"null",redirectCallback:!1,logoutCallback:!1,logoutAutoCallback:!1,keepAliveInterval:600,keepAliveUrl:window.location.href,keepAliveAjaxType:"GET",keepAliveAjaxData:"",lockEnabled:!1,lockTimeLimit:7200,lockHaltKeepAlive:!0,lockCallback:!1,lockContentCallback:!1,lockPassCallback:!1,lockTitle:null,lockUsername:"System User",lockMessage:"Enter your password to unlock the screen",lockUnlockButton:"UnLock",lockLogoutButton:"Not {username} ?",lockCountdownMessage:"Auto-logout in: {timer}",lockBlockUiConfig:{},lockLoadActive:!1,iframesSupport:!1,multiWindowSupport:!1},tt=$("body"),ot=null,nt={};nt.start=function(t){if(_=$.extend(_,t),null==_.logoutAutoUrl&&(_.logoutAutoUrl=_.logoutUrl),_.idleTimeLimit*=1e3,_.idleCheckHeartbeat*=1e3,_.warnTimeLimit*=1e3,_.lockTimeLimit*=1e3,_.keepAliveInterval*=1e3,_.multiWindowSupport&&!$.localStorage)return console.error("jitp: Multi-Window support requested but JQuery Storage API is unavailable."),!1;if(_.warnEnabled&&_.warnCallback===!1||_.lockEnabled&&_.lockCallback===!1)if(_.bootstrap){if("undefined"==typeof $.fn.modal)return console.error("jitp: Bootstrap library is unavailable"),!1}else if("undefined"==typeof jQuery.ui)return console.error("jitp: jQueryUI library is unavailable"),!1;if(_.lockEnabled&&!_.multiWindowSupport)return console.error("jitp: Lock screen requested but multi-window support is not enabled."),!1;if(_.lockEnabled&&_.lockCallback===!1){if("undefined"==typeof $.blockUI)return console.error("jitp: Lock screen requested but blockUI library is unavailable."),!1;if(_.lockPassCallback===!1)return console.error("jitp: Lock screen requested but lockPassCallback function is not set."),!1}return _.iframesSupport&&!_.multiWindowSupport?(console.error("jitp: IFrame support requested but Multi-Window support disabled."),!1):(o(),_.lockEnabled&&(_.lockLoadActive||e("lockStartTime",-1)>0)?U():(n("logoutTriggered",!1),n("warningStartTime",-1),n("lockStartTime",-1),n("lastActivity",$.now()),i(),_.keepAliveInterval&&u()),_.keepAliveInterval&&u(),F(),G(),c(),J(),!0)},nt.cleanUpLockScreen=function(){o(),$.localStorage&&ot.set("lockStartTime",-99)},nt.logout=function(){D()},nt.displayWarning=function(){w()},nt.displayLockScreen=function(){E()},nt.initLockScreen=function(){a(),f(),A()},nt.rollback=function(){L(),p()},nt.iframeRecheck=function(){J()};var et,lt,it,at,rt=[-1,-1],ct=!0,ut=!1,st=null,dt=null,pt=null,kt=!0,ft=!1,vt=null,wt=null;return nt});